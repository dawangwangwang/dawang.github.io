<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="向来拿不起,也放不下。QQ:1807801293">
    

    <!--Author-->
    
        <meta name="author" content="Yogurt">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="逻辑漏洞"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="向来拿不起,也放不下。QQ:1807801293" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Yogurt"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>逻辑漏洞 - Yogurt</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=990 height=86 src="//music.163.com/outchain/player?type=2&id=1299711624&auto=1&height=66"></iframe>
<header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2019/03/09/逻辑漏洞/">
                逻辑漏洞
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2019-03-09</span>
            
            
                <a href="#disqus_thread" class="comments">Comments</a>
            
            
                <span class="category">
                    <a href="/categories/web/">web</a>
                </span>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h1 id="逻辑漏洞定义"><a href="#逻辑漏洞定义" class="headerlink" title="逻辑漏洞定义"></a>逻辑漏洞定义</h1><p>逻辑漏洞是指由于程序逻辑不严谨或逻辑太复杂，导致一些逻辑分支不能正常处理或处理错误。  </p>
<p>通俗讲：一个系统的功能太多后，程序开发人员就难以思考全面，对其他地方可能有遗漏，或者未能正常处理，从而导致逻辑漏洞。逻辑漏洞也可以说是程序开发人员的思路错误、程序开发人员的逻辑存在漏洞。<br><a id="more"></a></p>
<h1 id="逻辑漏洞特性"><a href="#逻辑漏洞特性" class="headerlink" title="逻辑漏洞特性"></a>逻辑漏洞特性</h1><p>逻辑漏洞是非常隐蔽的，它不像SQL注入、XSS跨站脚本攻击、命令执行、文件上传漏洞等有鲜明的标识，自动化扫描器可以定义一系列的规则识别出这些漏洞，而逻辑漏洞一般出现在功能（业务流程）上，这是漏洞扫描工具无法识别的。  </p>
<p>逻辑漏洞只出现在业务流程中（模块功能），也就是说，网站的任何部分都有可能存在着逻辑错误漏洞。比如修改个人资料就完全可以出现逻辑错误漏洞。</p>
<h1 id="逻辑漏洞类型"><a href="#逻辑漏洞类型" class="headerlink" title="逻辑漏洞类型"></a>逻辑漏洞类型</h1><ul>
<li>支付漏洞<br>一、订单相关</li>
</ul>
<ol>
<li>选择商品时修改商品价格；</li>
<li>选择商品时将商品数量设置为负数；</li>
<li>商品剩余1时，多人同时购买，是否产生冲突；</li>
<li>商品为0时是否还能购买；</li>
<li>生成订单时修改订单金额；</li>
</ol>
<p>二、结算相关</p>
<ol>
<li>优惠打折活动多次重复使用；</li>
<li>拦截数据包，修改订单金额；</li>
<li>拦截数据包，修改支付方式；</li>
<li>伪造虚假订单，刷单；</li>
</ol>
<p>三、支付相关</p>
<ol>
<li>拦截数据包，伪造第三方确认信息；</li>
<li>保存用户付款信息被窃取；</li>
</ol>
<p>四、退货相关</p>
<ol>
<li>绕过商家确认直接退货；</li>
<li>绕过商品类型直接退货；（退货是否允许）</li>
</ol>
<p>五、收货相关</p>
<ol>
<li>绕过客户确认直接收货；</li>
</ol>
<ul>
<li>密码找回漏洞</li>
</ul>
<p>用户密码找回方式：<br>手机验证码、邮箱、密保问题、自动生成新密码、密码找回链接发送……<br>1.认证凭证暴力破解<br>2.认证凭证回显<br>3.认证凭证重复使用<br>4.用户身份特性认证<br>5.服务器端认证<br>6.本地认证<br>7.密码找回流程绕过<br>……</p>
<ul>
<li>任意用户登陆漏洞</li>
</ul>
<p>1.空密码绕过</p>
<ol start="2">
<li>身份替换<br>3.认证凭证篡改<br>4.……</li>
</ol>
<ul>
<li>认证缺陷（弱认证，认证凭证获取）</li>
<li>接口枚举</li>
</ul>
<p>有些关键性的接口因为没有做验证或者其它预防机制，容易遭到枚举攻击。<br>    1.某电商登陆接口无验证导致撞库<br>    2.某招聘网验证码无限制枚举<br>    3.某快递公司优惠券枚举<br>    4.……</p>
<ul>
<li><p>越权（有条件的越权：空值绕过）<br>……</p>
<h1 id="常见分类"><a href="#常见分类" class="headerlink" title="常见分类"></a>常见分类</h1><h2 id="逻辑漏洞包含四个模块："><a href="#逻辑漏洞包含四个模块：" class="headerlink" title="逻辑漏洞包含四个模块："></a>逻辑漏洞包含四个模块：</h2></li>
<li><p>用户体系</p>
</li>
<li>在线支付</li>
<li>顺序执行</li>
<li>本地限制/抓包绕过</li>
</ul>
<h2 id="包含的问题（危害）："><a href="#包含的问题（危害）：" class="headerlink" title="包含的问题（危害）："></a>包含的问题（危害）：</h2><ol>
<li>密码重置 任意密码修改</li>
<li>cookie验证问题</li>
<li>越权操作问题</li>
<li>交易支付金额任意修改</li>
<li>…… <h1 id="常见挖掘姿势"><a href="#常见挖掘姿势" class="headerlink" title="常见挖掘姿势"></a>常见挖掘姿势</h1>黑客挖掘逻辑漏洞时的一般操作步骤如下：</li>
</ol>
<p>1).发现网站所提供的功能模块。比如，修改密码、找回密码、修改个人资料等功能。</p>
<p>2).针对具体的功能确定业务流程，详细划分具体步骤，以购物为例介绍，购物流程如下：</p>
<ul>
<li>挑选商品，商品可多选</li>
<li>立刻购买，在“立刻购买”按钮旁边可以选择购买数量、购买样式等；</li>
<li>显示购买信息，在此步骤可以给卖家留言，填写购买数量，使用优惠券、匿名购买、找人付款；</li>
<li>提交订单；</li>
<li>付款</li>
</ul>
<p>3).拦截HTTP/HTTPS请求，分析其参数项的含义；</p>
<p>4)修改参数值，尝试触发逻辑漏洞；</p>
<p>5)返回第二步骤，对其他功能继续测试。</p>
<h1 id="密码重置"><a href="#密码重置" class="headerlink" title="密码重置"></a>密码重置</h1><p><img src="/2019/03/09/逻辑漏洞/3-8.png" alt=""></p>
<h1 id="支付交易"><a href="#支付交易" class="headerlink" title="支付交易"></a>支付交易</h1><p><img src="/2019/03/09/逻辑漏洞/3-88.png" alt=""></p>
<h1 id="授权验证绕过-常见检测手段"><a href="#授权验证绕过-常见检测手段" class="headerlink" title="授权验证绕过_常见检测手段"></a>授权验证绕过_常见检测手段</h1><p><img src="/2019/03/09/逻辑漏洞/3-888.png" alt=""></p>
<h2 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h2><p>非授权访问时指用户在没有通过认证授权的情况下能够直接访问需要通过认证才能访问到的页面或文本信息。尝试将一些敏感的页面链接复制于其他浏览器或其他电脑上进行访问，看是否能访问成功。</p>
<h2 id="越权访问"><a href="#越权访问" class="headerlink" title="越权访问"></a>越权访问</h2><ol>
<li>垂直越权(垂直越权是指使用权限低的用户可以访问权限较高的用户)</li>
<li>水平越权(水平越权是指相同权限的不同用户可以互相访问)<h1 id="密码找回-常见检测手段"><a href="#密码找回-常见检测手段" class="headerlink" title="密码找回_常见检测手段"></a>密码找回_常见检测手段</h1><img src="/2019/03/09/逻辑漏洞/3-8888.png" alt=""></li>
</ol>
<p>1)密码找回的凭证太弱，如只需要填入一个四位或者六位的纯数字就可以重置密码，导致可以暴力破解。</p>
<p>2)密码找回凭证可从客户端直接获取</p>
<p>3)密码找回凭证在页面中可以直接获取</p>
<p>4)用户找回密码的邮箱地址或者手机号码被修改</p>
<p>5)在最后提交修改的密码处的逻辑错误。</p>
<h1 id="条件竞争"><a href="#条件竞争" class="headerlink" title="条件竞争"></a>条件竞争</h1><p>条件竞争漏洞是一种服务器端的漏洞，由于服务器端在处理<br>不同的请求时是并发进行的，因此，如果并发处理不当或相关<br>操作逻辑顺序设计的不合理时，将会导致安全问题的发生 </p>
<p>攻击方式 ：文件上传</p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/逻辑漏洞/">#逻辑漏洞</a>
        </div>
    

    <!-- Comments -->
    
    <div class="comments">
        
<div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



    </div>
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    希望每个人都能找到自己的不可替代。
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2019/09/08/PHP代码审计/">PHP代码审计</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/05/27/ISCC2019/">ISCC2019（线上赛5月）</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/05/24/Django-debug-page-XSS漏洞-CVE-2017-12794-分析/">Django debug page XSS漏洞(C</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/05/15/缓存中间件/">缓存中间件</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/随笔/">随笔</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/漏洞分析/">漏洞分析</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/报错/">报错</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/CTF环境搭建/">CTF环境搭建</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="https://plus.google.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-google-plus"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:1807801293@qq.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    This is Yogurt
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'klugjotest';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body>

</html>